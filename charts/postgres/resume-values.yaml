# Values for resume-backend Postgres (managed by all-infrastructure)
fullnameOverride: resume-backend
auth:
  database: resume_db
  username: resume_user
  existingSecret: resume-backend-postgresql
  secretKeys:
    # The existing SealedSecret for resume-backend-postgresql uses the key
    # name 'postgresql-password' (see cluster-resources/sealed-secrets/...), so
    # ensure the chart's admin password key aligns with that. The Bitnami chart
    # may expect 'postgres-password' by default, but our SealedSecret uses
    # 'postgresql-password' so we configure the chart accordingly here.
    adminPasswordKey: postgresql-password
    userPasswordKey: postgresql-password
architecture: standalone
primary:
  persistence:
    # For the small resume backend we use a Node-local PV (local-storage) to avoid
    # consuming the tenancy's OCI Always Free block volume quota. If you prefer
    # to use OCI block storage, set storageClassName: oci-block-storage instead.
    storageClass: local-storage
    # Some Helm charts accept storageClassName instead of storageClass. We set both
    # to ensure the underlying StatefulSet's volumeClaimTemplates get the correct
    # storageClassName field for dynamic provisioning.
    storageClassName: local-storage
    size: 2Gi
    # The chart will auto-create a PVC that binds to the resume-postgres-local-pv
    # PersistentVolume. Do not use existingClaim so the chart can manage the PVC lifecycle.
    volumeName: resume-postgres-local-pv
  resources:
    requests:
      cpu: 50m
      memory: 256Mi
    limits:
      cpu: 250m
      memory: 512Mi
metrics:
  # Postgres exporter sidecar - enabled means the exported metrics are available
  # on the Postgres exporter process (default port 9187) and can be scraped by Alloy.
  # We do not deploy Prometheus ServiceMonitor here: Alloy will scrape directly and remote_write to Mimir.
  enabled: true
  serviceMonitor:
    # We do not deploy Prometheus in this environment; disable ServiceMonitor to avoid ServiceMonitor CRD creation.
    enabled: false
    interval: 3m
    scrapeTimeout: 10s
