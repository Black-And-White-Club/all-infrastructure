# Tempo - Distributed tracing backend
# Stores distributed traces from all services
# Query via Grafana with trace IDs or service filters
# Stores trace blocks in OCI Object Storage

global:
  extraEnvFrom:
    - secretRef:
        name: objectstore-creds

tempo:
  replicas: 1

  config:
    global:
      metrics_generator_collection_interval: 15s
      metrics_generator_enabled: true
      metrics_generator_processors:
        - batch
        - memory_limiter
        - attributes
        - span
        - service-graphs

  ingester:
    max_block_duration: 5m

  compactor:
    compaction:
      block_retention: 48h
      compacted_block_retention: 10m
      compaction_window: 1h
      max_block_bytes: 107374182400

  storage:
    trace:
      backend: s3
      s3:
        bucket: tempo-shared-bucket
        endpoint: id2uwn5pyixh.compat.objectstorage.us-ashburn-1.oraclecloud.com
        access_key: ${TEMPO_OCI_ACCESS_KEY}
        secret_key: ${TEMPO_OCI_SECRET_KEY}
        insecure: false
        forcepathstyle: true
      wal:
        path: /var/tempo/wal

  resources:
    requests:
      cpu: 25m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  persistence:
    enabled: false
